<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Awaaz | Admin - Reports</title>
	<link rel="stylesheet" href="/static/css/dark.css" />
	<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#000000] text-[#f5f5f7]">
	<div class="container max-w-7xl mx-auto px-4">
		<header class="flex items-center justify-between py-6">
			<h1 class="text-2xl font-semibold text-red-500">⚠️ Reports Management</h1>
			<div class="space-x-3 text-sm">
				<a class="text-blue-400 hover:text-blue-300" href="{% url 'admin_dashboard' %}">Dashboard</a>
				<span class="text-zinc-400">|</span>
				<a class="text-blue-400 hover:text-blue-300" href="/">Public Feed</a>
				<span class="text-zinc-400">|</span>
				<span class="text-zinc-400">Admin: {{ request.user.username }}</span>
				<span class="text-zinc-400">|</span>
				<a class="text-red-400 hover:text-red-300" href="{% url 'admin_logout' %}">Logout</a>
			</div>
		</header>

		{% if messages %}
			{% for message in messages %}
				<div class="mb-4 p-4 rounded-md {% if message.tags == 'error' %}bg-red-900 text-red-200{% else %}bg-green-900 text-green-200{% endif %}">
					{{ message }}
				</div>
			{% endfor %}
		{% endif %}

		<!-- Stats Cards -->
		<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
			<div class="card p-4">
				<h3 class="text-sm font-medium text-zinc-400">Pending Reports</h3>
				<p class="text-2xl font-bold text-yellow-400">{{ pending_count }}</p>
			</div>
			<div class="card p-4">
				<h3 class="text-sm font-medium text-zinc-400">Verified Reports</h3>
				<p class="text-2xl font-bold text-red-400">{{ verified_count }}</p>
			</div>
			<div class="card p-4">
				<h3 class="text-sm font-medium text-zinc-400">Dismissed Reports</h3>
				<p class="text-2xl font-bold text-green-400">{{ dismissed_count }}</p>
			</div>
		</div>

		<!-- Filters -->
		<div class="card p-4 mb-6">
			<form method="get" class="flex flex-wrap gap-4 items-end">
				<div class="flex-1 min-w-[200px]">
					<label class="block text-sm text-zinc-400 mb-1">Status</label>
					<select name="status" class="w-full rounded-md bg-[#0f0f14] border border-[#2a2a36] p-2">
						<option value="">All</option>
						<option value="pending" {% if request.GET.status == 'pending' %}selected{% endif %}>Pending</option>
						<option value="verified" {% if request.GET.status == 'verified' %}selected{% endif %}>Verified</option>
						<option value="dismissed" {% if request.GET.status == 'dismissed' %}selected{% endif %}>Dismissed</option>
					</select>
				</div>
				<div class="flex-1 min-w-[200px]">
					<label class="block text-sm text-zinc-400 mb-1">Reason</label>
					<select name="reason" class="w-full rounded-md bg-[#0f0f14] border border-[#2a2a36] p-2">
						<option value="">All</option>
						<option value="false_complaint" {% if request.GET.reason == 'false_complaint' %}selected{% endif %}>False Complaint</option>
						<option value="wrong_location" {% if request.GET.reason == 'wrong_location' %}selected{% endif %}>Wrong Location</option>
						<option value="misinformation" {% if request.GET.reason == 'misinformation' %}selected{% endif %}>Misinformation</option>
					</select>
				</div>
				<div class="flex-1 min-w-[200px]">
					<label class="block text-sm text-zinc-400 mb-1">Search</label>
					<input type="text" name="q" value="{{ request.GET.q }}" placeholder="Search..." class="w-full rounded-md bg-[#0f0f14] border border-[#2a2a36] p-2">
				</div>
				<div>
					<button type="submit" class="rounded-md bg-blue-600 hover:bg-blue-500 px-4 py-2">Filter</button>
					<a href="{% url 'admin_reports' %}" class="rounded-md bg-zinc-700 hover:bg-zinc-600 px-4 py-2 ml-2">Clear</a>
				</div>
			</form>
		</div>

		<!-- Reports Table -->
		<div class="card p-4">
			<div class="overflow-x-auto">
				<table class="w-full">
					<thead>
						<tr class="border-b border-[#2a2a36]">
							<th class="text-left p-3 text-sm font-medium text-zinc-400">Complaint</th>
							<th class="text-left p-3 text-sm font-medium text-zinc-400">Reporter</th>
							<th class="text-left p-3 text-sm font-medium text-zinc-400">Reason</th>
							<th class="text-left p-3 text-sm font-medium text-zinc-400">Status</th>
							<th class="text-left p-3 text-sm font-medium text-zinc-400">Date</th>
							<th class="text-left p-3 text-sm font-medium text-zinc-400">Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for report in reports %}
							<tr class="border-b border-[#2a2a36] hover:bg-[#1a1a1a]">
								<td class="p-3">
									<a href="{% url 'complaint_detail' report.complaint.pk %}" class="text-blue-400 hover:text-blue-300">
										{{ report.complaint.title|truncatewords:5 }}
									</a>
								</td>
								<td class="p-3 text-sm">{{ report.reporter.username }}</td>
								<td class="p-3 text-sm">{{ report.get_reason_display }}</td>
								<td class="p-3">
									<span class="px-2 py-1 rounded text-xs font-medium
										{% if report.status == 'pending' %}bg-yellow-900 text-yellow-200
										{% elif report.status == 'verified' %}bg-red-900 text-red-200
										{% else %}bg-green-900 text-green-200{% endif %}">
										{{ report.get_status_display }}
									</span>
								</td>
								<td class="p-3 text-sm text-zinc-400">{{ report.created_at|date:"M d, Y" }}</td>
								<td class="p-3">
									<a href="{% url 'admin_report_detail' report.pk %}" class="text-blue-400 hover:text-blue-300 text-sm">View</a>
								</td>
							</tr>
						{% empty %}
							<tr>
								<td colspan="6" class="p-6 text-center text-zinc-400">No reports found.</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
			
			<!-- Pagination -->
			{% if reports.has_other_pages %}
				<div class="mt-4 flex justify-center gap-2">
					{% if reports.has_previous %}
						<a href="?page={{ reports.previous_page_number }}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}{% if request.GET.reason %}&reason={{ request.GET.reason }}{% endif %}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="px-3 py-1 rounded-md bg-zinc-700 hover:bg-zinc-600">Previous</a>
					{% endif %}
					<span class="px-3 py-1 text-zinc-400">Page {{ reports.number }} of {{ reports.paginator.num_pages }}</span>
					{% if reports.has_next %}
						<a href="?page={{ reports.next_page_number }}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}{% if request.GET.reason %}&reason={{ request.GET.reason }}{% endif %}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="px-3 py-1 rounded-md bg-zinc-700 hover:bg-zinc-600">Next</a>
					{% endif %}
				</div>
			{% endif %}
		</div>
	</div>
</body>
</html>

